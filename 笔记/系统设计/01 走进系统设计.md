# 通过本文你可以学到

- 系统设计中常说的 Tradeoff 是什么  
- 什么叫做 SOA (Service Oriented Architecture)  
- 什么是 Pull Model & 什么是 Push Model
- 数据存储系统有哪些，什么样的数据适合存在什么样的数据存储系统中
- 什么是异步任务和消息队列 (Message Queue)  
- 什么是数据的可持久化 (Persistent)  
- 什么是去标准化 (Denormalize)  
- 什么是惊群效应 (Thundering Herd)  
- 有哪些与 News Feed 类似的系统设计问题?

# 系统设计面试的形式及常见的系统设计面试问题  

- 面试的形式来说，和我们的算法面试和编程面试有很大的区别，就是题目描述非常的简短。通常都是十分开放的话题，题目的要求很少，这就要求面试者具备和面试官交流的能力
- 当你经验不太丰富时，还有一种更加具体的形式就是叫你设计某某系统中的某某功能

## 设计某某系统 Design XXX System 
- 设计微博 Design Twitter  
- 设计人人 Design Facebook  
- 设计滴滴 Design Uber
- 设计微信 Design Whatsapp  
- 设计点评 Design Yelp  
- 设计短网址系统 Design Tiny URL
- 设计NoSQL数据库 Design NoSQL

## 设计某某系统中的某某功能  
- 设计一个功能实现对用户访问频率的限制  
- 设计一个功能实现统计某个具体事件的历史发生次数
- 设计删除一个Tweet的功能  
- 设计邮件系统中将所有邮件标记为已读的功能

# 系统设计与面向对象设计的异同

## 形式上

- 面向对象
	- 设计手把手的 Coding 
- 系统设计
	- 高屋建瓴的“扯淡”

## 考察的知识点上  

- 面向对象设计
	- Class
	- Object
	- Method
	- Inheritance
	- Interface ...`
- 系统设计考的是
	- Database
	- Schema
	- SQL
	- NoSQL
	- Memcached
	- File System
	- Distributed System
	- Latency, Scalbility
	- Master Slave
	- Load Balancer
	- Web Server
	- Message Queue
	- Sharding, Consistent Hashing
	- QPS ...`

 ## 典型题
 
 - 面向对象设计
	 - 电梯设计
	 - 游戏设计
 - 系统设计
	 - 短网址系统设计
	 - 新鲜事系统设计

# Interviewer: Please design twitter

## 系统设计面试的常见错误  

- 当你拿到这个问题的时候，你该对面试官说些什么，很多人一上来就是，关键词大师，给出一大堆关键词，但是考虑了其他的因素了吗？没有明确的需求，系统设计往往都是失败的

![](image/Pasted%20image%2020221004170952.png)

- 所以，第一步都是和面试官去沟通，去细化这个问题，给出自己的解决方案

## 系统设计面试的评分标准

- 为了在系统设计这一个环节中，得到面试官更好的评价，我们到底要在面试中展现出一些什么东西，如下图
	1. 你是否提出了一个可行解，针对面试官的问题
	2. 你提出来的一个大框架，时候能解决在这个领域中的一些特定问题
	3. 在这个过程中，面试官不断的给你提出问题，你不断的通过逻辑分析解决的能力
	4. 你在面对多个方式时，你如何让效益最大化，或者什么情况下 A 好，什么情况下 B 好
	5. 知识储备是真的很难通过背八股文解决的，这真的就是自己的硬实力，光看书是虚的，动起手来，实战很重要

![](image/Pasted%20image%2020221004171210.png)

# 系统设计的九阴真经 - 4S 分析法  

- **Scenario**
- **Service** 
- **Storage**
- **Scale**

![](image/Pasted%20image%2020221004172232.png)

## Storage 存储

### 数据如何存储和访问

![](image/Pasted%20image%2020221004173319.png)

![](image/Pasted%20image%2020221004175103.png)

#### 文件系统和数据库系统

##### 关系

- 数据库系统是文件系统的一层包装，他们不是独立的关系，是依赖的关系。
- 数据库系统依赖于文件系统。

##### 区别

- 数据库系统提供了更丰富的数据操作，很细。
- 文件系统只提供了简单的文件操作接口，很粗。 
- 以关系型数据库(Relational Database) 为例，提供了 SQL 语句这样的丰富的查询语言，可以一些复杂的 filter，如快速找出学生信息表中，所有 20-24 岁的学生信息。
- 如果直接在文件系统上，则需要 扫描完所有的学生数据后才能找到。
- 数据库系统中读取的数据，大部分情况下(除了被 cache 的)，都还是会到文件系统上去读取出来的，因此两个系统的读写效率(不考虑复杂查询)可以认为是差不多的。

### Interviewer: Please design schema

- 主键，通常都是业务无关的

![](image/Pasted%20image%2020221004181023.png)

### Interviewer: News Feed 如何存取

#### 什么是新鲜事 News Feed? 

- 你登陆 Facebook / Twitter / 朋友圈 之后看到的信息流
- 你的所有朋友发的信息的集合

 #### 有哪些典型的新鲜事系统?

-   Facebook
-   Twitter
-   朋友圈
-   RSS Reader

#### 新鲜事系统的核心因素

- 关注与被关注
- 每个人看到的新鲜事都是不同的

### Pull Model

- Pull = 主动撩Ta

#### 算法

- 在用户查看News Feed时，获取每个好友的前100条Tweets，合并出前100条News Feed
	- K路归并算法 Merge K Sorted Arrays

#### 复杂度分析  
- News Feed => 假如有N个关注对象，则为N次DB Reads的时间 + N路归并时间(可忽略)
	- 为什么K路归并的时间可以忽略？
- Postatweet=>1次DBWrite的时间

#### Interviewer: Pull模型有什么缺陷么

![](image/Pasted%20image%2020221004223959.png)

### Select 为每个 Service 选择存储结构

### Schema 细化表结构

#### 原理图

![](image/Pasted%20image%2020221004223706.png)

#### 缺陷



# 后续课程安排