# 消息不完整和消息粘包

## 消息粘包

![](image/Pasted%20image%2020250115172012.png)

![](image/Pasted%20image%2020250115172120.png)

![](image/Pasted%20image%2020250115172140.png)

![](image/Pasted%20image%2020250115172245.png)

## 消息不完整

![](image/Pasted%20image%2020250115172557.png)

![](image/Pasted%20image%2020250115172731.png)

![](image/Pasted%20image%2020250115173045.png)

## 复现消息传输错误

![](image/Pasted%20image%2020250115173136.png)

# 如何有序的混传数据

![](image/Pasted%20image%2020250115175605.png)

## 起止符方案

![](image/Pasted%20image%2020250115180403.png)

### 实现

![](image/Pasted%20image%2020250115180743.png)

## 固定头部描述

![](image/Pasted%20image%2020250115180513.png)

### 实现

![](image/Pasted%20image%2020250115180826.png)

## 借鉴 HTTP

![](image/Pasted%20image%2020250115180923.png)

### HTTP 1.X

![](image/Pasted%20image%2020250116001306.png)

![](image/Pasted%20image%2020250116001456.png)

### HTTP 2.X

![](image/Pasted%20image%2020250116002340.png)

#### Connection

![](image/Pasted%20image%2020250116002404.png)

#### Frame

![](image/Pasted%20image%2020250116002951.png)
#### Header 9-byte

![](image/Pasted%20image%2020250116003041.png)

# 稳定性优化总结

## 构建有序消息体

![](image/Pasted%20image%2020250116132453.png)

## 类关系

![](image/Pasted%20image%2020250116132639.png)

![](image/Pasted%20image%2020250116133025.png)

