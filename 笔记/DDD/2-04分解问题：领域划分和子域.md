# 本节内容

![](image/Pasted%20image%2020220909213541.png)

# 什么是领域划分

![](image/Pasted%20image%2020220909220741.png)

- 产品经理梳理出了 6 大核心顶层用户故事，我们之前说过用户故事就是对问题的描述，从这一点来说，用户故事和领域划分是很搭配的，那么这些用户故事可以划分吗，或者说可以分类吗？

![](image/Pasted%20image%2020220910000623.png)

- 通过这样的划分，它们功能区分非常明显，面相的用户角色不一样，操作入口也不一样，于是就划分成大的两个子域，一个解决交易问题，一个解决运营问题，这个时候我们就进行了初步的领域划分，那么有个问题就是：这样的领域划分是否已经足够了呢？领域划分要到什么粒度才算合理呢？

![](image/Pasted%20image%2020220910001203.png)

- 为了搞清楚这个问题，我们要理解为什么要进行领域划分

# 为什么要进行领域划分以及传统模式的问题

- 在常见的开发流程和分工模式，首先产品经理提需求写文档，接下来开发 Leader 把需求分配到不同的开发同学进行技术方案设计和编码，你觉得这种以需求为粒度进行分工协作的方式，有什么问题？用下面的案例来分析，就可以看出问题了，假设我们把产品梳理出的六个顶层故事，逐个分配个六个不同的开发团队，会出现什么问题呢？

![](image/Pasted%20image%2020220910003650.png)

- 请注意，在项目时间压力比较大，而研发Leader又没有做太多思考的情况下，这种分工是很容易出现的，看起来并发度很高，大家同步开发，但是这种分工协作有两个致命的问题。

## 问题点和领域知识重叠

![](image/Pasted%20image%2020220913082552.png)

- 我们以售卖机扫码支付购物和柜门免密购物这两个用户故事为例，这两个用户故事你深入进入，发现它们涉及到很多问题，其中包括三个问题

1. 支付问题
2. 交易流程
3. 设备操纵

- 假设这两组用户故事分配给了两组开发小组，那么这两组开发小组就得同时关注这三个方面的问题，压力很大不说，还进行了重复劳动，同时做几件事情是很容易出问题的。何况还有重叠的工作，这样效率极低，代码之前还会发生冲突

## 模型重叠

![](image/Pasted%20image%2020220913083855.png)

- 从这两个用户故事分别分析下去，都会提炼出来几个关键的概念：商品、订单、售卖机这些概念最终都会转变成代码，那么这两组开发同学又会出现冲突，最后这几个概念对应的类的设计，到底是谁说了算呢？

## 小结

- 上面这两个问题最终导致的后果，归根结底

1. 效率低
2. 职责重叠导致冲突

而解决它们的问题就是领域划分

## 领域划分可以解决传统模式的问题

![](image/Pasted%20image%2020220913091639.png)

- 我们把这两个涉及到的用户故事细分后，形成几个子域，其中就包括了支付域、交易域、设备域，不同子域交给不同的人来负责，对应不同的概念会被划分到不同的子域，其实确切的说，概念的圈定是后面要介绍的限界上下文的职责，但是限界上下文和子域是紧密相关的，在理想的设计下，子域和限界上下文是一一对应的，这样的划分以后，问题就迎刃而解了，不同的开发同学面对的是不同的开发问题，使得工作更聚焦了，也没有重复劳动和冲突的问题了

- 那么接下来的问题就是怎样进行领域划分了，在架构师能力比较强，经验比较丰富，直接通过直觉和经验去进行领域划分也是可以的，其实软件系统设计也有它艺术性的一面，优美的划分本身就是解决方案的一部分，领域划分也是能体现架构师的能力的，但是有没有对领域划分有指导和辅助作用的固定方法吗？毕竟技术人员能力的强化是需要时间的，而且架构师的工作也最好有一种方法进行检验的，最好还能保证结果的准确性和效果的稳定性。

- 刚才我们其实已经透露了一点，领域划分是对问题空间的划分，而碰巧用户故事也是对问题的描述，那么是否可以借助用户故事对领域进行划分呢？就像我们之前划分出交易域和运营域那样，接下来我要介绍一种在实践中行之有效法的方法：基于用户故事分解的领域划分法，它利用的就是用户故事和领域划分的相关性

## 基于故事分解的领域划分

![](image/Pasted%20image%2020220913093020.png)

- 上面这张图就是我们使用domain storytelling分析售卖机扫码支付购物这个用户故事得到的图，之前说到domain storytelling有很多用处

1. 熟悉领域知识
2. 建立通用语言
3. 建立模型

- 其实它也可以认为是对用户故事的分解，每个序号