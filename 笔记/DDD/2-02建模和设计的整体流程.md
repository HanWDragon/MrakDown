# 本节内容

![](image/Pasted%20image%2020220906082832.png)

# 建模和设计的整体流程

- 所谓的建模和设计都是将领域知识和需求转化为代码的过程
- 在DDD中可以将这个过程划分为四个阶段

![](image/Pasted%20image%2020220906083140.png)

- 上图中，虽然开始时间有先后，但是是重叠进行的。不断的迭代优化
- 这就是建模涡流（Model Exploration Whirlpool），就是指两种活动交替完成，最后得到一个合理的模型。
- 比如我们在战略设计中，会将模型分解为限界上下文，但是随着建模的深入，你会发现我们可能需要分解出新的上下文，那么对战略设计进行完善，以及对通用语言进行补充，都是没有问题的，也是必须要做的
- 举一个更细的例子，在战略设计内部有先对领域划分然后再寻找限界上下文，理想情况下，子领域和限界上下文是一一对应的，但是我们可能会发现一个子领域，划分出了两个限界上下文，这就说明之前的领域划分是有问题的，而调整之后的领域划分，也能更好的指导限界上下文的划分
- 所以说建模设计过程，并不是一个那么规整过程，它是以形成一个最优模型为目的不断优化的一个过程

![](image/Pasted%20image%2020220906084605.png)

# 参与人员

- 其中领域专家是非常重要的角色，是在某个领域有深度经验专业人士，当我们要做一个外卖系统，外卖员就是领域专家，做一个医疗系统，医生就是领域专家，但是在现实情况大多都是产品经理来担当领域专家的角色，这也是可以的，但是必要的时候需要邀请相关行业的业内人士参与讨论

![](image/Pasted%20image%2020220906085706.png)

# 用户故事

- 建模与设计的第一步是要从用户故事开始，在敏捷开发中，用户故事是对软件系统特性的非正式的描述，是从终端用户的角度对问题的描述，所以是对问题空间的描述，很多团队在做产品的时候，一上来产品经理都会出一份无比细致的文稿，各种流程图和界面都一应俱全，开发同学也很喜欢用需求文档不细致这一点来怼产品，就像是一种政治正确，其实软件产品开发并不是按部就班的搬砖，再牛的产品经理，也做不到一开始就确定产品的最终方案，如果在各方压力下，真的尝试去做，一开始就从功能到界面全部定稿，不再更改，最后做出来的产品，可能会很奇怪，变化总是比计划多，好的产品一定是经过充分的讨论和反复修改打磨得到的，当然最终方案肯定是详细的，好的产品文档，也可以作为通用语言的文档，所以敏捷方法提倡在早期用用户故事来对需求进行恰到好处的描述，而不会太过细致
- 用户故事更多的是对问题的描述，而不是解决方案，通过从问题出发，通过整个团队的讨论论证，不断迭代，最终接近答案，就是最终的产品答案

![](image/Pasted%20image%2020220906100351.png)

# 通用语言

![](image/Pasted%20image%2020220906100511.png)

![](image/Pasted%20image%2020220906100612.png)

# 战略设计

![](image/Pasted%20image%2020220906100734.png)

![](image/Pasted%20image%2020220906100854.png)

- 确定上下文映射的关系，还会确定在哪里加入防腐层

# 战术设计

![](image/Pasted%20image%2020220906101057.png)

![](image/Pasted%20image%2020220906102855.png)

- 这些元素就是战略设计的主要结构元素，包括聚合、实体、子对象、工厂、仓库、模块、服务等等
- 这些元素确定下来后，代码基本上也就确定了
- 战术设计包括编码吗？其实架构师和设计人员是需要深度参与编码的，所以包括

# 常见建模方法

![](image/Pasted%20image%2020220906103025.png)

# 小结

![](image/Pasted%20image%2020220906103619.png)