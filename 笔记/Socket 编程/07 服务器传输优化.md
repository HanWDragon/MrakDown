# 阻塞 IO 和非阻塞 IO

- 之前发送还是接收都是通过开多线程来解决调用方法阻塞的问题，因为服务端需要不停的轮询来获取客户端的连接，这也是 BIO 的缺陷

# 阻塞 IO 

![](image/Pasted%20image%2020241222153617.png)

# 非阻塞 IO

 ![](image/Pasted%20image%2020241222154322.png)

![](image/Pasted%20image%2020241222155102.png)

# NIO Family 一览

![](image/Pasted%20image%2020241222155646.png)

![](image/Pasted%20image%2020241222155807.png)

## Buffer

![](image/Pasted%20image%2020241222155915.png)

![](image/Pasted%20image%2020241222160034.png)

## Channel

- 对于 Channel 读是独占的，写是独占的，读和写之间是异步的，可以两个线程操作
- eg：当传输大文件时，这个 Channel 的写入就是独占的

![](image/Pasted%20image%2020241222160539.png)

![](image/Pasted%20image%2020241222160638.png)

# NIO 常见 API

## NIO 职责

![](image/Pasted%20image%2020241222165201.png)

## Selector

### 注册事件
 ![](image/Pasted%20image%2020241222161145.png)
### 使用流程

![](image/Pasted%20image%2020241222161732.png)

![](image/Pasted%20image%2020241222162015.png)

### 注意事项

![](image/Pasted%20image%2020241222162144.png)

### SelectionKeys

![](image/Pasted%20image%2020241222162342.png)

 # NIO 重写服务器

## 重写哪些功能

- 需要修改 TCP Server 和 TCP Handler
	- 原先是开线程来进行 accept，现在在 start() 注册 Selecror
	- 原先是 ServerSocket 现在使用 ServerSocketChannel

![](image/Pasted%20image%2020241223105604.png)

